<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of ecm_display</title>
  <meta name="keywords" content="ecm_display">
  <meta name="description" content="ecm_display(model_name,network,v,options,ecm_options,c,u,u_tot,up,A_forward,r,kinetic_data,c_min,c_max,u_min,u_max)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">enzyme-cost-minimization</a> &gt; <a href="#">ecm_functions</a> &gt; ecm_display.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./enzyme-cost-minimization/ecm_functions&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>ecm_display
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>ecm_display(model_name,network,v,options,ecm_options,c,u,u_tot,up,A_forward,r,kinetic_data,c_min,c_max,u_min,u_max)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function ecm_display(model_name,network,v,options,ecm_options,c,u,u_tot,up,A_forward,r,kinetic_data,c_min,c_max,u_min,u_max) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> ecm_display(model_name,network,v,options,ecm_options,c,u,u_tot,up,A_forward,r,kinetic_data,c_min,c_max,u_min,u_max)

 ECM_DISPLAY - Display results of Enzyme Cost Minimization</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../.././enzyme-cost-minimization/ecm_simple.html" class="code" title="function [report, errors] = ecm_simple(infile, outdir, options)">ecm_simple</a>	[report, errors] = ecm_simple(infile, outdir, options)</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function ecm_display(model_name,network,v,options,ecm_options,c,u,u_tot,up,A_forward,r,kinetic_data,c_min,c_max,u_min,u_max)</a>
0002 
0003 <span class="comment">% ecm_display(model_name,network,v,options,ecm_options,c,u,u_tot,up,A_forward,r,kinetic_data,c_min,c_max,u_min,u_max)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% ECM_DISPLAY - Display results of Enzyme Cost Minimization</span>
0006 
0007 <span class="keyword">if</span> length(ecm_options.reaction_order_file),
0008   ecm_options.reaction_order   = load_any_table(ecm_options.reaction_order_file);
0009   ecm_options.metabolite_order = load_any_table(ecm_options.metabolite_order_file);
0010 <span class="keyword">end</span>
0011 
0012 <span class="comment">% -----------------------------------</span>
0013 <span class="comment">% info</span>
0014 
0015 display(<span class="string">'Fixed concentrations'</span>)
0016 pm(ecm_options.conc_fix,ecm_options.met_fix)
0017 
0018 <span class="comment">% -----------------------------------</span>
0019 
0020 [nm,nr] = size(network.N);
0021 
0022 value_colors  = flipud(colormapRGBmatrices); <span class="comment">% rb_colors;</span>
0023 enzyme_colors = sunrise_colors(length(ecm_options.ind_scored_enzymes));
0024 
0025 <span class="comment">%cm            = jet(length(ecm_options.ecm_scores));</span>
0026 ca
0027 
0028 <span class="keyword">if</span> ~isfield(ecm_options,<span class="string">'psfile_dir'</span>),
0029   ecm_options.print_graphics = 0;
0030   <span class="keyword">else</span>
0031     <span class="keyword">if</span> isempty(ecm_options.psfile_dir),
0032       ecm_options.print_graphics = 0;
0033     <span class="keyword">end</span>
0034 <span class="keyword">end</span>
0035 
0036 <span class="comment">% -----------------------------------</span>
0037 
0038 reaction_names = network.actions;
0039 
0040 <span class="keyword">if</span> isfield(network,<span class="string">'genes'</span>),
0041   gene_names     = network.genes;
0042 <span class="keyword">else</span>
0043   gene_names     = network.actions;
0044 <span class="keyword">end</span>
0045   
0046 <span class="keyword">if</span> ~isfield(ecm_options,<span class="string">'reaction_order'</span>),
0047   ecm_options.reaction_order = reaction_names;
0048 <span class="keyword">else</span>,
0049   <span class="keyword">if</span> isempty(ecm_options.reaction_order),
0050     ecm_options.reaction_order = {};
0051   <span class="keyword">end</span>
0052   ll = label_names(ecm_options.reaction_order,reaction_names);
0053   ecm_options.reaction_order = ecm_options.reaction_order(find(ll));
0054   ecm_options.reaction_order = [column(ecm_options.reaction_order); column(setdiff(reaction_names,ecm_options.reaction_order))];
0055 <span class="keyword">end</span>
0056 
0057 ind_genes        = label_names(reaction_names,ecm_options.reaction_order);
0058 ind_genes_rev    = label_names(ecm_options.reaction_order,reaction_names);
0059 ind_genes_scored = ecm_options.ind_scored_enzymes(ind_genes_rev);
0060 
0061 
0062 <span class="comment">% -----------------------------------</span>
0063 
0064 <span class="keyword">if</span> ~isfield(ecm_options,<span class="string">'metabolite_order'</span>),
0065   ecm_options.metabolite_order = network.metabolites;
0066 <span class="keyword">else</span>,
0067   ecm_options.metabolite_order = [column(ecm_options.metabolite_order); column(setdiff(network.metabolites,ecm_options.metabolite_order))];
0068 <span class="keyword">end</span>
0069 
0070 ind_show_met = [];
0071 <span class="keyword">for</span> it = 1:length(ecm_options.metabolite_order),
0072   my_metabolite = intersect(ecm_options.metabolite_order{it},ecm_options.show_metabolites);
0073   <span class="keyword">if</span> length(my_metabolite),
0074     ind_show_met = [ ind_show_met, label_names(my_metabolite, network.metabolites)];
0075   <span class="keyword">end</span>
0076 <span class="keyword">end</span>
0077 ind_show_met = ind_show_met(find(ind_show_met));
0078 
0079 <span class="comment">% -----------------------------------</span>
0080 <span class="comment">% GENERAL PLOTS</span>
0081 <span class="comment">% -----------------------------------</span>
0082 
0083 gp = struct(<span class="string">'arrowsize'</span>,0.05,<span class="string">'arrowstyle'</span>,<span class="string">'fluxes'</span>,<span class="string">'actstyle'</span>,<span class="string">'none'</span>,<span class="string">'arrowvalues'</span>,v);
0084 figure(27); netgraph_concentrations(ecm_options.network_CoHid,[],v,1,gp);
0085 
0086 figure(4); clf; 
0087 gp = struct(<span class="string">'arrowsize'</span>,0.05,<span class="string">'actstyle'</span>,<span class="string">'none'</span>,<span class="string">'colorbar'</span>,1,<span class="string">'showsign'</span>,0,<span class="string">'actprintnames'</span>,1,<span class="string">'metprintnames'</span>,0,<span class="string">'flag_edges'</span>,1,<span class="string">'colormap'</span>, value_colors);
0088 gp.actvaluesmin = log10(10);
0089 gp.actvaluesmax = log10(10000);
0090 gp.actstyle     = <span class="string">'fixed'</span>;
0091 gp.arrowstyle   = <span class="string">'none'</span>;
0092 netgraph_concentrations(ecm_options.network_CoHid,[],log10(r.Kcatf),1,gp); 
0093 title(<span class="string">'log10 Kcat+, balanced (1/s)'</span>);
0094 
0095 figure(14); clf;
0096 <span class="keyword">if</span> length(kinetic_data),
0097   gp = struct(<span class="string">'arrowsize'</span>,0.05,<span class="string">'actstyle'</span>,<span class="string">'none'</span>,<span class="string">'colorbar'</span>,1,<span class="string">'showsign'</span>,0,<span class="string">'actprintnames'</span>,1,<span class="string">'metprintnames'</span>,0,<span class="string">'flag_edges'</span>,1,<span class="string">'colormap'</span>, value_colors);
0098   gp.actvaluesmin = log10(10);
0099   gp.actvaluesmax = log10(10000);
0100   gp.actstyle     = <span class="string">'fixed'</span>;
0101   gp.arrowstyle   = <span class="string">'none'</span>;
0102   netgraph_concentrations(ecm_options.network_CoHid,[],log10(kinetic_data.Kcatf.median),1,gp); 
0103   title(<span class="string">'log10 Kcat+, original (1/s)'</span>);
0104 <span class="keyword">else</span>
0105   text(1,1,<span class="string">'No data'</span>);
0106 <span class="keyword">end</span>
0107 
0108 figure(11); clf; 
0109 gp.actstyle     = <span class="string">'none'</span>;
0110 gp.metvaluesmin = log10(ecm_options.conc_min_default);
0111 gp.metvaluesmax = log10(100);<span class="comment">% (ecm_options.conc_max_default);</span>
0112 netgraph_concentrations(network,log10(c.initial(:,1)),[],1,gp); title(<span class="string">'Initial state: log10 Concentrations (mM)'</span>);
0113 
0114 figure(12); clf; 
0115 gp.arrowstyle   =<span class="string">'none'</span>; gp.actstyle = <span class="string">'fixed'</span>;
0116 gp.actvaluesmin = log10(1);
0117 gp.actvaluesmax = log10(100);
0118 gp.metvaluesmin = [];
0119 gp.metvaluesmax = [];
0120 netgraph_concentrations(ecm_options.network_CoHid,[],log10(A_forward.initial),1,gp); title(<span class="string">'Inital state: log10 Reaction affinities (kJ/mol)'</span>);
0121 
0122 figure(8); clf
0123 gp = struct(<span class="string">'arrowstyle'</span>,<span class="string">'none'</span>,<span class="string">'colorbar'</span>,1,<span class="string">'showsign'</span>,0,<span class="string">'actprintnames'</span>,0,<span class="string">'flag_edges'</span>,1,<span class="string">'colormap'</span>, value_colors);
0124 gp.metvaluesmin = log10(ecm_options.conc_min_default);
0125 gp.metvaluesmax = log10(100); <span class="comment">% ecm_options.conc_max_default);</span>
0126 netgraph_concentrations(network,log10(c.data(:,1)),[],1,gp); title(<span class="string">'Experimental data (1st file): log10 Concentrations (mM)'</span>);
0127 
0128 figure(28); clf
0129 gp = struct(<span class="string">'arrowstyle'</span>,<span class="string">'none'</span>,<span class="string">'colorbar'</span>,1,<span class="string">'showsign'</span>,0,<span class="string">'actprintnames'</span>,0,<span class="string">'flag_edges'</span>,1,<span class="string">'colormap'</span>, value_colors);
0130 gp.metvaluesmin = log10(ecm_options.conc_min_default);
0131 gp.metvaluesmax = log10(100); <span class="comment">% ecm_options.conc_max_default);</span>
0132 netgraph_concentrations(network,log10(c.fixed),[],1,gp); title(<span class="string">'Fixed values: log10 Concentrations (mM)'</span>);
0133 
0134 figure(9); clf
0135 gp = struct(<span class="string">'arrowstyle'</span>,<span class="string">'none'</span>,<span class="string">'colorbar'</span>,1,<span class="string">'showsign'</span>,0,<span class="string">'actprintnames'</span>,1,<span class="string">'flag_edges'</span>,1,<span class="string">'colormap'</span>, value_colors);
0136 gp.actnames     = gene_names;
0137 gp.actvaluesmin = log10(nanmin(u.data));
0138 gp.actvaluesmax = log10(nanmax(u.data));
0139 gp.metvaluesmin = [];
0140 gp.metvaluesmax = [];
0141 netgraph_concentrations(ecm_options.network_CoHid,[],log10(u.data),1,gp); title(<span class="string">'Experimental data: log10 enzyme levels (mM)'</span>);
0142 
0143 
0144 <span class="comment">% --------------------------------------</span>
0145 <span class="comment">% concentration predictions</span>
0146 
0147 <span class="comment">% everything in one picture</span>
0148 
0149 figure(18); clf; hold on;
0150 set(gcf,<span class="string">'Position'</span>,[100 300 1000 500])
0151 xtick = 0:length(ind_show_met)-1;
0152 h     = [];
0153 my_ecm_scores = [{<span class="string">'initial'</span>},ecm_options.ecm_scores];
0154 <span class="keyword">for</span> it = 1:length(my_ecm_scores),
0155   ecm_score = my_ecm_scores{it};
0156   h(it)     = plot(xtick,c.(ecm_score)(ind_show_met,1) * exp(0.03*it),<span class="string">'-'</span>,<span class="string">'MarkerSize'</span>,20); <span class="comment">%  * exp(0.001*it)</span>
0157 <span class="keyword">end</span>
0158 line_colors(h,<span class="string">'sunrise_colors'</span>);
0159 
0160 plot(xtick,c.fixed(ind_show_met),<span class="string">'r.'</span>,<span class="string">'MarkerSize'</span>,30);
0161 <span class="keyword">if</span> length(c.data),
0162   n_c_data_sets = size(c.data,2);
0163   plot(repmat(column(xtick),n_c_data_sets,1),reshape(c.data(ind_show_met,:),n_c_data_sets * length(ind_show_met),1),<span class="string">'k.'</span>,<span class="string">'MarkerSize'</span>,20); 
0164   methods = [my_ecm_scores,{<span class="string">'fixed'</span>,<span class="string">'data'</span>}];
0165 <span class="keyword">else</span>
0166   methods = [my_ecm_scores,{<span class="string">'fixed'</span>}];
0167 <span class="keyword">end</span>
0168 
0169 metnames_show = strrep(network.metabolites(ind_show_met),<span class="string">'D-'</span>,<span class="string">''</span>);
0170 metnames_show = strrep(metnames_show,<span class="string">'_'</span>,<span class="string">'.'</span>);
0171 
0172 text(xtick + 0.2,c.data(ind_show_met),metnames_show,<span class="string">'FontSize'</span>,10);
0173 legend(methods,<span class="string">'Location'</span>,<span class="string">'NorthEastOutside'</span>,<span class="string">'FontSize'</span>,10);
0174 axis tight; set(gca,<span class="string">'XTick'</span>,xtick,<span class="string">'XTickLabel'</span>,metnames_show,<span class="string">'YScale'</span>,<span class="string">'Log'</span>);
0175 my_xticklabel([],ecm_options.conc_min_default,[],10);
0176 title(<span class="string">'Comparison: log10 Concentration profiles (mM)'</span>);
0177 
0178 
0179 
0180 <span class="comment">% --------------------------------------</span>
0181 <span class="comment">% reaction affinity predictions</span>
0182 
0183 figure(19); clf; hold on;
0184 set(gcf,<span class="string">'Position'</span>,[200 400 1000 500])
0185 xtick = 0:length(network.actions);
0186 h = [];
0187 
0188 my_ecm_scores = [{<span class="string">'initial'</span>},ecm_options.ecm_scores];
0189 
0190 <span class="keyword">for</span> it = 1:length(my_ecm_scores),
0191   ecm_score = my_ecm_scores{it};
0192   h(it)     = plot(xtick,[0; -cumsum(v .* A_forward.(ecm_score)(:,1))] + (0.002*it),<span class="string">'-'</span>); <span class="comment">%</span>
0193 <span class="keyword">end</span>
0194 line_colors(h,<span class="string">'sunrise_colors'</span>);
0195 
0196 legend(my_ecm_scores,<span class="string">'Location'</span>,<span class="string">'NorthEast'</span>,<span class="string">'FontSize'</span>,16);
0197 axis tight; set(gca,<span class="string">'XTick'</span>,xtick,<span class="string">'XTickLabel'</span>,[{<span class="string">''</span>};strrep(network.actions,<span class="string">'_'</span>, <span class="string">' '</span>)]);
0198 my_xticklabel([],[],[],10);
0199 title(<span class="string">'Cumulative entropy production (v * A)'</span>);
0200 
0201 
0202 <span class="comment">% --------------------------------------</span>
0203 <span class="comment">% c over KM</span>
0204 
0205 figure(20); subplot(<span class="string">'Position'</span>,[0.15 0.05 0.8 0.7]);
0206 c_over_KM = repmat(c.initial(:,1)',length(network.actions),1)./r.KM;
0207 c_over_KM(r.KM==0) = nan;
0208 im(log10(c_over_KM(:,ind_show_met)),[-3,3],network.actions,metnames_show); colormap([0.95 0.95 0.95; value_colors]); colorbar
0209 my_xticklabel
0210 <span class="comment">%title('log10 c (initial solution) / KM');</span>
0211 
0212 
0213 <span class="comment">% --------------------------------------</span>
0214 <span class="comment">% KM</span>
0215 
0216 <span class="comment">% data</span>
0217 figure(21); subplot(<span class="string">'Position'</span>,[0.15 0.05 0.8 0.7]);
0218 <span class="keyword">if</span> length(kinetic_data),
0219   my_KM = kinetic_data.KM.median;
0220   my_KM(my_KM==0) = nan;
0221   im(log10(my_KM(:,ind_show_met)),[-3,2],network.actions,metnames_show); colormap([0.95 0.95 0.95; value_colors]); colorbar
0222   my_xticklabel
0223 <span class="keyword">else</span>
0224   text(1,1,<span class="string">'No data'</span>);
0225 <span class="keyword">end</span>
0226 
0227 <span class="comment">% balanced</span>
0228 figure(22); subplot(<span class="string">'Position'</span>,[0.15 0.05 0.8 0.7]);
0229 my_KM = r.KM;
0230 my_KM(my_KM==0) = nan;
0231 im(log10(my_KM(:,ind_show_met)),[-3,2],network.actions,metnames_show); colormap([0.95 0.95 0.95; value_colors]); colorbar
0232 my_xticklabel
0233 
0234 
0235 
0236 <span class="comment">% --------------------------------------</span>
0237 <span class="comment">% enzyme level predictions</span>
0238 
0239 <span class="comment">% barplot for all methods</span>
0240 
0241 figure(33); clf; 
0242 
0243 ug      = [];
0244 methods = ecm_options.ecm_scores;
0245 
0246 <span class="keyword">for</span> it = 1:length(ecm_options.ecm_scores),
0247   ecm_score = ecm_options.ecm_scores{it};
0248   ug_meth   = up.(ecm_score)(ecm_options.ind_scored_enzymes,1);
0249   ug_meth   = ug_meth/sum(ug_meth);
0250   ug        = [ug, ug_meth];
0251 <span class="keyword">end</span>
0252 
0253 <span class="keyword">if</span> length(u.data),
0254   ug_data = u.data(ecm_options.ind_scored_enzymes) / nansum(u.data(ecm_options.ind_scored_enzymes));
0255   ug      = [ug, ug_data];
0256   methods = [methods,{<span class="string">'data'</span>}];
0257 <span class="keyword">end</span>
0258 
0259 h = bar(flipud(ug(ind_genes_scored,:))',<span class="string">'stacked'</span>);
0260 colormap(flipud(enzyme_colors)); 
0261 axis([0,3+length(ecm_options.ecm_scores), 0, 1.02]); 
0262 legend(fliplr(h),gene_names(ind_genes_scored),<span class="string">'Fontsize'</span>,8,<span class="string">'Location'</span>,<span class="string">'East'</span>)
0263 set(gca,<span class="string">'FontSize'</span>,12);
0264 set(gca,<span class="string">'XTickLabel'</span>,methods); ylabel(<span class="string">'Relative protein amount'</span>);
0265 
0266 <span class="comment">% color legend</span>
0267 
0268 figure(34); clf; 
0269 mmm = nan * ones(nr,1); 
0270 mmm(ecm_options.ind_scored_enzymes) = ind_genes(ecm_options.ind_scored_enzymes);
0271 gpp = struct(<span class="string">'actprintnames'</span>,1,<span class="string">'arrowstyle'</span>,<span class="string">'none'</span>,<span class="string">'showsign'</span>,0,<span class="string">'colormap'</span>,enzyme_colors,<span class="string">'text_offset'</span>,[0.03,0]);
0272 gpp.actnames = gene_names;
0273 netgraph_concentrations(ecm_options.network_CoHid,[],column(mmm),1,gpp); 
0274 <span class="comment">%title('Enzymes colour legend');</span>
0275 
0276 <span class="comment">% proteomap from data</span>
0277 
0278 <span class="keyword">if</span> length(u.data),
0279   ud = u.data(ecm_options.ind_scored_enzymes);
0280   ud = ud / nansum(ud);
0281   ud = ud(ind_genes_scored);
0282   proteomap_draw_treemap(gene_names(ind_genes_scored),ud,{<span class="string">'Protein data'</span>},struct(<span class="string">'color_file'</span>,enzyme_colors,<span class="string">'show_level'</span>,1,<span class="string">'window_position'</span>,[250,120,600,600],<span class="string">'fignums'</span>,350)); <span class="comment">% title('');</span>
0283 <span class="keyword">end</span>
0284 
0285 <span class="comment">% % proteomap from predictions</span>
0286 <span class="comment">%</span>
0287 <span class="comment">% for it_method = 1:n_methods,</span>
0288 <span class="comment">%   this_ecm_score = ecm_options.ecm_scores{it_method};</span>
0289 <span class="comment">%   ug   = up.(this_ecm_score)(ecm_options.ind_scored_enzymes,1);</span>
0290 <span class="comment">%   ug = ug / nansum(ug);</span>
0291 <span class="comment">%   ug = ug(ind_genes_scored);</span>
0292 <span class="comment">%   proteomap_draw_treemap(gene_names(ind_genes_scored),ug,{this_ecm_score},struct('color_file',enzyme_colors,'show_level',1,'window_position',[250,120,600,600], 'fignums', 350+it_method)); %title('');</span>
0293 <span class="comment">% end</span>
0294 
0295 
0296 <span class="comment">% -----------------------------------</span>
0297 <span class="comment">% PLOTS FOR MEASURED DATA ONLY</span>
0298 <span class="comment">% -----------------------------------</span>
0299 
0300 <span class="comment">% ---------------------------------------------</span>
0301 <span class="comment">% plot flux (data) versus enzyme level (data)</span>
0302 
0303 figure(44); clf; hold on
0304 is_finite  = isfinite(u.data .* v);
0305 ind_finite = find(is_finite);
0306 my_colors  = enzyme_colors(ind_genes,:);
0307 <span class="keyword">for</span> it = 1:nr,
0308   <span class="keyword">if</span> is_finite(it),
0309     plot(u.data(it),v(it),<span class="string">'.'</span>,<span class="string">'Color'</span>,my_colors(it,:),<span class="string">'MarkerSize'</span>,30);
0310   <span class="keyword">end</span>
0311 <span class="keyword">end</span>
0312 text(u.data(ind_finite) * 1.03,v(ind_finite),gene_names(ind_finite));
0313 set(gca,<span class="string">'XScale'</span>,<span class="string">'Log'</span>,<span class="string">'YScale'</span>,<span class="string">'Log'</span>,<span class="string">'Fontsize'</span>,16);
0314 xlabel(<span class="string">'Measured enzyme level (mM)'</span>,<span class="string">'Fontsize'</span>,16); ylabel(<span class="string">'Measured flux'</span>,<span class="string">'Fontsize'</span>,16);
0315 axis equal; axis square; axis tight
0316 <span class="keyword">if</span> length(ind_finite),
0317   [cc, pvalue] = corr(log(u.data(ind_finite)),log(v(ind_finite)));
0318   [cc_spear, pvalue_spear] = corr(log(u.data(ind_finite)),log(v(ind_finite)),<span class="string">'type'</span>,<span class="string">'Spearman'</span>);
0319   title(sprintf(<span class="string">'r (Pearson correlation): %2.2f [p-value %2.3f]\n r (Spearman rank corr): %2.2f [p-value %2.3f]'</span>,cc,pvalue,cc_spear,pvalue_spear));
0320 <span class="keyword">end</span>
0321 
0322 
0323 <span class="comment">% --------------------------------------------------------</span>
0324 <span class="comment">% plot flux (data) versus enzyme level * kcat (both data)</span>
0325 
0326 figure(45);clf; hold on
0327 <span class="keyword">if</span> length(kinetic_data)
0328   is_finite  = isfinite(u.data .* kinetic_data.Kcatf.median .* v);
0329   ind_finite = find(is_finite);
0330   my_colors  = enzyme_colors(ind_genes,:);
0331   <span class="keyword">for</span> it = 1:nr,
0332      <span class="keyword">if</span> is_finite(it),
0333        plot(u.data(it),v(it)/kinetic_data.Kcatf.median(it),<span class="string">'.'</span>,<span class="string">'Color'</span>,my_colors(it,:),<span class="string">'MarkerSize'</span>,30);
0334      <span class="keyword">end</span>
0335   <span class="keyword">end</span>
0336   text(u.data(ind_finite) * 1.03,v(ind_finite)  ./ kinetic_data.Kcatf.median(ind_finite),gene_names(ind_finite));
0337   set(gca,<span class="string">'XScale'</span>,<span class="string">'Log'</span>,<span class="string">'YScale'</span>,<span class="string">'Log'</span>,<span class="string">'Fontsize'</span>,16);
0338   xlabel(<span class="string">'Measured enzyme level (mM)'</span>,<span class="string">'Fontsize'</span>,16); ylabel(<span class="string">'Measured flux / kcat (data)'</span>,<span class="string">'Fontsize'</span>,16);
0339   axis equal; axis square; axis tight
0340   <span class="keyword">if</span> length(ind_finite),
0341     [cc, pvalue] = corr(log(u.data(ind_finite)),log(v(ind_finite)./kinetic_data.Kcatf.median(ind_finite)));
0342     [cc_spear, pvalue_spear] = corr(log(u.data(ind_finite)),log(v(ind_finite)./kinetic_data.Kcatf.median(ind_finite)),<span class="string">'type'</span>,<span class="string">'Spearman'</span>);
0343     title(sprintf(<span class="string">'r (Pearson correlation): %2.2f [p-value %2.3f]\n r (Spearman rank corr): %2.2f [p-value %2.3f]'</span>,cc,pvalue,cc_spear,pvalue_spear));
0344   <span class="keyword">end</span>
0345 <span class="keyword">else</span>
0346   text(1,1,<span class="string">'No data'</span>);
0347 <span class="keyword">end</span>
0348 
0349 <span class="comment">% --------------------------------------------------------</span>
0350 <span class="comment">% barplot</span>
0351 
0352 figure(46); clf; 
0353 n_methods = length(ecm_options.ecm_scores);
0354 
0355 <span class="keyword">for</span> it_method = 1:n_methods,
0356   this_ecm_score = ecm_options.ecm_scores{it_method};
0357   ug   = up.(this_ecm_score)(ecm_options.ind_scored_enzymes,1);
0358   subplot(n_methods+1,1,it_method); hold on;set(gca,<span class="string">'FontSize'</span>,10);
0359   <span class="keyword">for</span> it = 1:length(ind_genes_scored);
0360     h = bar(it,ug(ind_genes_scored(it))); set(h,<span class="string">'FaceColor'</span>,enzyme_colors(it,:)); 
0361   <span class="keyword">end</span>
0362   ylabel(sprintf(<span class="string">'%s'</span>,this_ecm_score));
0363   set(gca,<span class="string">'XTick'</span>,[]); 
0364 <span class="keyword">end</span>
0365 
0366 ud   = u.data(ecm_options.ind_scored_enzymes,1);
0367 subplot(n_methods+1,1,it_method+1); hold on
0368 <span class="keyword">for</span> it = 1:length(ind_genes_scored);
0369   h= bar(it,ud(ind_genes_scored(it))); set(h,<span class="string">'FaceColor'</span>,enzyme_colors(it,:)); 
0370 <span class="keyword">end</span>
0371 ylabel(<span class="string">'Data'</span>);
0372 set(gca,<span class="string">'FontSize'</span>,6);
0373 set(gca,<span class="string">'XTick'</span>,1:length(ind_genes_scored),<span class="string">'XTickLabel'</span>,gene_names(ind_genes_scored)); 
0374 
0375 
0376 <span class="comment">% --------------------------------------------------------</span>
0377 
0378 <span class="comment">% --------------------------------------------------------</span>
0379 <span class="comment">% SAVE GRAPHICS</span>
0380 <span class="comment">% --------------------------------------------------------</span>
0381 
0382 
0383 <span class="keyword">if</span> ecm_options.print_graphics,
0384   cd(ecm_options.psfile_dir);
0385   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_fluxes.eps'</span>],<span class="string">'-f27'</span>,<span class="string">'-depsc'</span>);
0386   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_data_concentrations.eps'</span>],<span class="string">'-f8'</span>,<span class="string">'-depsc'</span>);
0387   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_data_enzymes.eps'</span>],<span class="string">'-f9'</span>,<span class="string">'-depsc'</span>);
0388   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_fix_concentrations.eps'</span>],<span class="string">'-f28'</span>,<span class="string">'-depsc'</span>);
0389   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_init_concentrations.eps'</span>],<span class="string">'-f11'</span>,<span class="string">'-depsc'</span>);
0390   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_init_affinities.eps'</span>],<span class="string">'-f12'</span>,<span class="string">'-depsc'</span>);
0391   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_kcat_balanced.eps'</span>],<span class="string">'-f4'</span>,<span class="string">'-depsc'</span>);
0392   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_kcat_original.eps'</span>],<span class="string">'-f14'</span>,<span class="string">'-depsc'</span>);
0393   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_barplot.eps'</span>],<span class="string">'-f33'</span>,<span class="string">'-depsc'</span>);
0394   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_barplot_legend.eps'</span>],<span class="string">'-f34'</span>,<span class="string">'-depsc'</span>);
0395   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_all_conc_profiles.eps'</span>],<span class="string">'-f18'</span>,<span class="string">'-depsc'</span>);
0396   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_affinity_profiles.eps'</span>],<span class="string">'-f19'</span>,<span class="string">'-depsc'</span>);
0397   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_c_by_KM_initial.eps'</span>],<span class="string">'-f20'</span>,<span class="string">'-depsc'</span>);
0398   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_KM_original.eps'</span>],<span class="string">'-f21'</span>,<span class="string">'-depsc'</span>);
0399   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_KM_balanced.eps'</span>],<span class="string">'-f22'</span>,<span class="string">'-depsc'</span>);
0400   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_scatter_enzyme_vs_flux.eps'</span>],<span class="string">'-f44'</span>,<span class="string">'-depsc'</span>);
0401   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_scatter_enzyme_kcat_vs_flux.eps'</span>],<span class="string">'-f45'</span>,<span class="string">'-depsc'</span>);
0402   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_enzyme_multiple_barplots.eps'</span>],<span class="string">'-f46'</span>,<span class="string">'-depsc'</span>);
0403   print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_proteomap_data.eps'</span>],<span class="string">'-f350'</span>,<span class="string">'-depsc'</span>);
0404 <span class="keyword">end</span>
0405 
0406 
0407 <span class="comment">% -----------------------------------</span>
0408 <span class="comment">% PLOTS FOR INDIVIDUAL SCORES</span>
0409 <span class="comment">% -----------------------------------</span>
0410 
0411 
0412 <span class="keyword">for</span> it_method = 1:length(ecm_options.ecm_scores),
0413   this_ecm_score = ecm_options.ecm_scores{it_method};
0414   
0415   my_c = c.(this_ecm_score)(:,1);
0416   my_A_forward = A_forward.(this_ecm_score)(:,1);
0417   my_up = up.(this_ecm_score)(:,1);
0418 
0419   figure(1); clf; 
0420   gp.actstyle = <span class="string">'none'</span>;
0421   gp.metvaluesmin = log10(ecm_options.conc_min_default);
0422   gp.metvaluesmax = log10(100);<span class="comment">%ecm_options.conc_max_default);</span>
0423   netgraph_concentrations(network,log10(my_c),[],1,gp); title(<span class="string">'Optimised state: log10 Concentrations (mM)'</span>);
0424   
0425   figure(2); clf; 
0426   gp.arrowstyle=<span class="string">'none'</span>; 
0427   gp.actstyle = <span class="string">'fixed'</span>;
0428   gp.actvaluesmin = log10(0.01);
0429   gp.actvaluesmax = log10(100);
0430   gp.metvaluesmin = [];
0431   gp.metvaluesmax = [];
0432   netgraph_concentrations(ecm_options.network_CoHid,[],log10(my_A_forward),1,gp); title(<span class="string">'Optimised state: log10 Reaction affinities (kJ/mol)'</span>);
0433   
0434   figure(3); clf; 
0435   gp.actnames  = gene_names;
0436   gp.actvaluesmin = log10(10^-6);
0437   gp.actvaluesmax = log10(10^-2);
0438   gp.metvaluesmin = [];
0439   gp.metvaluesmax = [];
0440   netgraph_concentrations(ecm_options.network_CoHid,[],log10(my_up),1,gp); title(<span class="string">'Optimised state: log10 Enzyme levels (mM)'</span>);
0441 
0442   <span class="comment">% --------------------------------------------------------</span>
0443 
0444   figure(101); clf; hold on;
0445   set(gcf,<span class="string">'Position'</span>,[100 300 1000 500])
0446   xtick      = 0:length(ind_show_met)-1;
0447   this_c     = c.(this_ecm_score)(ind_show_met,1);
0448   <span class="keyword">if</span> length(c_min),
0449     this_c_min = c_min.(this_ecm_score)(ind_show_met);
0450     this_c_max = c_max.(this_ecm_score)(ind_show_met);
0451   <span class="keyword">else</span>
0452     this_c_min = 0;
0453     this_c_max = 0;
0454   <span class="keyword">end</span>
0455   ind_fixed  = find(label_names(metnames_show, ecm_options.met_fix));
0456 
0457   h = errorbar(xtick,this_c,this_c-this_c_min,this_c_max-this_c,<span class="string">'o'</span>,<span class="string">'LineWidth'</span>,2);
0458   h = plot(xtick(ind_fixed),this_c(ind_fixed),<span class="string">'r.'</span>,<span class="string">'MarkerSize'</span>,30);
0459   <span class="keyword">if</span> length(c.data),
0460     n_c_data_sets = size(c.data,2);
0461     plot(repmat(column(xtick),n_c_data_sets,1),reshape(c.data(ind_show_met,:),n_c_data_sets * length(ind_show_met),1),<span class="string">'k.'</span>,<span class="string">'MarkerSize'</span>,20); 
0462     methods = {this_ecm_score,<span class="string">'fixed'</span>,<span class="string">'data'</span>};
0463   <span class="keyword">else</span>
0464     methods = {this_ecm_score,<span class="string">'fixed'</span>};
0465   <span class="keyword">end</span>
0466   metnames_show = strrep(metnames_show,<span class="string">'D-'</span>,<span class="string">''</span>);
0467   text(xtick + 0.2,c.(this_ecm_score)(ind_show_met),metnames_show,<span class="string">'FontSize'</span>,10);
0468   legend(methods,<span class="string">'Location'</span>,<span class="string">'NorthEastOutside'</span>,<span class="string">'FontSize'</span>,10);
0469   ylabel(<span class="string">'Concentration [mM]'</span>);
0470   axis tight; set(gca,<span class="string">'YScale'</span>,<span class="string">'Log'</span>,<span class="string">'XTick'</span>,[]); 
0471   <span class="comment">% a = axis; hold on</span>
0472   <span class="comment">% for itttt = 1:length(xtick),</span>
0473   <span class="comment">%   plot([xtick(itttt),xtick(itttt)],[a(3),a(4)],'-');</span>
0474   <span class="comment">% end</span>
0475   
0476   
0477   <span class="comment">% --------------------------------------</span>
0478   <span class="comment">% enzyme predictions scatter plot</span>
0479   
0480   figure(102); clf; hold on; set(gcf,<span class="string">'Position'</span>,[150 350 600 600])
0481   is_finite  = isfinite(u.data) .* [v~=0];
0482   ind_finite = find(is_finite);
0483   my_colors  = enzyme_colors(ind_genes,:);
0484   <span class="comment">% plot points, then axis tight, then lines</span>
0485   <span class="keyword">for</span> it = 1:nr,
0486     <span class="keyword">if</span> is_finite(it),
0487       plot(u.data(it),u.(this_ecm_score)(it,1),<span class="string">'.'</span>,<span class="string">'Markersize'</span>,30,<span class="string">'Color'</span>,my_colors(it,:)); 
0488     <span class="keyword">end</span>
0489   <span class="keyword">end</span>
0490   axis tight; axis equal; axis square; 
0491   <span class="keyword">for</span> it = 1:nr,
0492     <span class="keyword">if</span> is_finite(it) * [1-isempty(u_min)],
0493       <span class="keyword">if</span> isfield(u_min,this_ecm_score)
0494         plot(u.data(it) * [1 1],[u_min.(this_ecm_score)(it),u_max.(this_ecm_score)(it)],<span class="string">'-'</span>,<span class="string">'Color'</span>,my_colors(it,:)); 
0495       <span class="keyword">end</span>
0496     <span class="keyword">end</span>
0497   <span class="keyword">end</span>
0498   text(1.05*u.data(ind_finite),1.05*u.(this_ecm_score)(ind_finite,1),network.genes(ecm_options.ind_scored_enzymes(ind_finite)),<span class="string">'FontSize'</span>,8);
0499   xlabel(<span class="string">'Measured enzyme level (mM)'</span>,<span class="string">'Fontsize'</span>,16);
0500   ylabel(sprintf(<span class="string">'Predicted enzyme level (mM) %s'</span>,this_ecm_score),<span class="string">'Fontsize'</span>,16);
0501   set(gca,<span class="string">'XScale'</span>,<span class="string">'Log'</span>,<span class="string">'YScale'</span>,<span class="string">'Log'</span>,<span class="string">'Fontsize'</span>,16);
0502 <span class="keyword">if</span> length(ind_finite),
0503   [cc, pvalue] = corr(log(u.data(ind_finite)),log(u.(this_ecm_score)(ind_finite,1)));
0504   [cc_spear, pvalue_spear] = corr(log(u.data(ind_finite)),log(u.(this_ecm_score)(ind_finite,1)),<span class="string">'type'</span>,<span class="string">'Spearman'</span>);
0505   title(sprintf(<span class="string">'r (Pearson correlation): %2.2f [p-value %2.3f]\n r (Spearman rank corr): %2.2f [p-value %2.3f]'</span>,cc,pvalue,cc_spear,pvalue_spear));
0506 <span class="keyword">end</span>  
0507   
0508   <span class="comment">% --------------------------------------</span>
0509   <span class="comment">% concentration predictions scatter plot</span>
0510   
0511   figure(103); clf; hold on; set(gcf,<span class="string">'Position'</span>,[150 350 600 600])
0512   
0513   my_c_min = min(nanmin(c.data(:)),nanmin(c.(this_ecm_score)(:)));
0514   my_c_max = max(nanmax(c.data(:)),nanmax(c.(this_ecm_score)(:)));
0515   
0516   plot([my_c_min,my_c_max],[my_c_min,my_c_max],<span class="string">'-'</span>);
0517   ind_non_fixed = find(label_names(network.metabolites, ecm_options.met_fix)==0);
0518   
0519   <span class="keyword">for</span> itt = 1:length(ind_non_fixed),
0520     it = ind_non_fixed(itt);
0521     plot([nanmin(c.data(it,:)),nanmax(c.data(it,:))],c.(this_ecm_score)(it,1) * [1 1],<span class="string">'-'</span>,<span class="string">'Color'</span>,[.7 .7 .7]);
0522     <span class="keyword">if</span> [1-isempty(c_min)],
0523       <span class="keyword">if</span> isfield(c_min,this_ecm_score),
0524       plot(nanmean(c.data(it,:))* [1 1],[c_min.(this_ecm_score)(it),c_max.(this_ecm_score)(it)],<span class="string">'k'</span>,<span class="string">'Color'</span>,[.5 0 0]);
0525       <span class="keyword">end</span>
0526     <span class="keyword">end</span>
0527     plot(nanmean(c.data(it,:)),c.(this_ecm_score)(it,1),<span class="string">'r.'</span>,<span class="string">'Markersize'</span>,20);
0528     text(1.1*nanmean(c.data(it,:)),1.1*c.(this_ecm_score)(it,1),strrep(network.metabolites{it},<span class="string">'_'</span>,<span class="string">'.'</span>),<span class="string">'FontSize'</span>,6);  
0529   <span class="keyword">end</span>
0530   
0531   axis tight; axis equal; axis square; 
0532   xlabel(<span class="string">'Median experimental concentration (mM)'</span>,<span class="string">'Fontsize'</span>,16);
0533   ylabel(sprintf(<span class="string">'Predicted concentration (mM) %s'</span>,this_ecm_score),<span class="string">'Fontsize'</span>,16);
0534   set(gca,<span class="string">'XScale'</span>,<span class="string">'Log'</span>,<span class="string">'YScale'</span>,<span class="string">'Log'</span>,<span class="string">'Fontsize'</span>,16);
0535   
0536   my_nanmean_c_data   = nanmean(c.data,2);
0537   ind_finite          = find(isfinite(my_nanmean_c_data));
0538 <span class="keyword">if</span> length(ind_finite),
0539   [cc, pvalue] = corr(log(my_nanmean_c_data(ind_finite)),log(c.(this_ecm_score)(ind_finite,1)));
0540   [cc_spear, pvalue_spear] = corr(log(my_nanmean_c_data(ind_finite)),log(c.(this_ecm_score)(ind_finite,1)),<span class="string">'type'</span>,<span class="string">'Spearman'</span>);
0541   title(sprintf(<span class="string">'r (Pearson correlation): %2.2f [p-value %2.3f]\n r (Spearman rank corr): %2.2f [p-value %2.3f]'</span>,cc,pvalue,cc_spear,pvalue_spear));
0542 <span class="keyword">end</span>
0543 
0544   <span class="comment">% --------------------------------------------------------</span>
0545   <span class="comment">% barplot</span>
0546   
0547   ug   = up.(this_ecm_score)(ecm_options.ind_scored_enzymes,1);
0548   ud   = u.data(ecm_options.ind_scored_enzymes,1);
0549   
0550   figure(104); clf; 
0551   subplot(2,1,1);
0552   <span class="keyword">for</span> it = 1:length(ind_genes_scored);
0553     h = bar(it,ug(ind_genes_scored(it))); set(h,<span class="string">'FaceColor'</span>,enzyme_colors(it,:)); hold on
0554   <span class="keyword">end</span>
0555   ylabel(sprintf(<span class="string">'Predicted enzyme level [mM] %s'</span>,this_ecm_score));
0556   title(sprintf(<span class="string">'Total predicted enzyme level (%s): %f mM'</span>,this_ecm_score, sum(ug(ind_genes_scored))));
0557 
0558   subplot(2,1,2);
0559   <span class="keyword">for</span> it = 1:length(ind_genes_scored);
0560     h= bar(it,ud(ind_genes_scored(it))); set(h,<span class="string">'FaceColor'</span>,enzyme_colors(it,:)); hold on
0561   <span class="keyword">end</span>
0562   set(gca,<span class="string">'FontSize'</span>,8);
0563   set(gca,<span class="string">'XTick'</span>,1:length(ind_genes_scored),<span class="string">'XTickLabel'</span>,gene_names(ind_genes_scored)); 
0564   ylabel(<span class="string">'Measured enzyme level [mM]'</span>);
0565   set(gca,<span class="string">'FontSize'</span>,8);
0566 
0567   <span class="comment">% --------------------------------------</span>
0568 <span class="comment">% c over KM</span>
0569 
0570 figure(105); subplot(<span class="string">'Position'</span>,[0.15 0.05 0.8 0.7]);
0571 c_over_KM = repmat(c.(this_ecm_score)(:,1)',length(network.actions),1)./r.KM;
0572 c_over_KM(r.KM==0) = nan;
0573 im(log10(c_over_KM(:,ind_show_met)),[-3,3],network.actions,metnames_show); colormap([0.95 0.95 0.95; value_colors]); colorbar
0574 my_xticklabel
0575 <span class="comment">%title('log10 c (initial solution) / KM');</span>
0576 
0577   
0578   <span class="comment">% --------------------------------------------------------</span>
0579   <span class="comment">%% arrow cost diagram</span>
0580 
0581   figure(1500); set(gca,<span class="string">'FontSize'</span>,14);
0582   my_kcat = r.Kcatf;
0583   my_A_forward = A_forward.(this_ecm_score);
0584   my_eta_energ = 1-exp(-my_A_forward);
0585   my_eta_energ(my_eta_energ&lt;0)=0;
0586   my_u         = u.(this_ecm_score);
0587   my_h         = ecm_options.enzyme_cost_weights;
0588   my_v         = v;
0589   plot(my_v,<span class="string">'-'</span>,<span class="string">'Color'</span>,[0.3 0.3 0.3],<span class="string">'Linewidth'</span>,2); hold on
0590   plot(my_v./my_kcat,<span class="string">'-'</span>,<span class="string">'Color'</span>,[0 0 0.9],<span class="string">'Linewidth'</span>,2);
0591   plot(my_v./my_kcat./my_eta_energ,<span class="string">'-'</span>,<span class="string">'Color'</span>,[0.8 0 0.8],<span class="string">'Linewidth'</span>,2);
0592   plot(my_u,<span class="string">'-'</span>,<span class="string">'Color'</span>,[1 0 0],<span class="string">'Linewidth'</span>,2);
0593   plot(my_u.*my_h,<span class="string">'--'</span>,<span class="string">'Color'</span>,[0.9 0.6 0],<span class="string">'Linewidth'</span>,2);
0594   set(gca, <span class="string">'YScale'</span>,<span class="string">'Log'</span>); hold off
0595   title(this_ecm_score)
0596   my_xticklabel(1:length(network.actions),10^-5,strrep(network.actions,<span class="string">'_'</span>,<span class="string">'-'</span>)')
0597   xlabel(<span class="string">'Enzymes'</span>);
0598   ylabel(<span class="string">'Enzyme cost measures'</span>);
0599   legend(<span class="string">'Flux'</span>,<span class="string">'Flux/k_{cat}'</span>,<span class="string">'Flux/(k_{cat}*\eta^{energy})'</span>,<span class="string">'Enzyme'</span>,<span class="string">'Enzyme cost'</span>);
0600 
0601   
0602 
0603   <span class="comment">% -------------------------------------------------------------------------------------</span>
0604   
0605   <span class="keyword">if</span> ecm_options.print_graphics,
0606     cd(ecm_options.psfile_dir);
0607     print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_'</span> this_ecm_score <span class="string">'_opt_concentrations.eps'</span>],<span class="string">'-f1'</span>,<span class="string">'-depsc'</span>);
0608     print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_'</span> this_ecm_score <span class="string">'_opt_affinities.eps'</span>],    <span class="string">'-f2'</span>,<span class="string">'-depsc'</span>);
0609     print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_'</span> this_ecm_score <span class="string">'_opt_enzymes.eps'</span>],       <span class="string">'-f3'</span>,<span class="string">'-depsc'</span>);
0610     print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_'</span> this_ecm_score <span class="string">'_conc_prediction.eps'</span>],  <span class="string">'-f101'</span>,<span class="string">'-depsc'</span>);
0611     print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_'</span> this_ecm_score <span class="string">'_enzyme_scatter.eps'</span>], <span class="string">'-f102'</span>,<span class="string">'-depsc'</span>);
0612     print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_'</span> this_ecm_score <span class="string">'_conc_scatter.eps'</span>], <span class="string">'-f103'</span>,<span class="string">'-depsc'</span>);
0613     print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_'</span> this_ecm_score <span class="string">'_enzyme_prediction.eps'</span>],<span class="string">'-f104'</span>,<span class="string">'-depsc'</span>);
0614     print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_'</span> this_ecm_score <span class="string">'_c_by_KM.eps'</span>],<span class="string">'-f105'</span>,<span class="string">'-depsc'</span>);
0615     print([ model_name <span class="string">'_'</span> ecm_options.run_id <span class="string">'_'</span> this_ecm_score <span class="string">'_arrow_cost_diagram.eps'</span>],<span class="string">'-depsc'</span>,<span class="string">'-f1500'</span>);
0616   <span class="keyword">end</span>
0617   
0618 <span class="keyword">end</span>
0619 
0620 <span class="keyword">if</span> ecm_options.print_graphics,
0621   display(sprintf(<span class="string">'Graphics files written to directory %s'</span>,ecm_options.psfile_dir));
0622 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 12-Feb-2015 14:18:00 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>